<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jadwal Latihan Gym Interaktif (Lacak Set)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F7F4; /* Soft beige background */
        }
        .day-btn {
            transition: all 0.2s ease-in-out;
        }
        .day-btn.active {
            background-color: #1E3A8A; /* Deep blue */
            color: #FFFFFF;
            transform: translateY(-4px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .exercise-card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            padding: 1.5rem;
        }
        .exercise-group h3 {
            color: #1E3A8A; /* Deep blue for group titles */
            font-weight: 700;
            border-bottom: 2px solid #DBEAFE; /* Light blue border */
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        .editable-list {
            min-height: 100px; /* Ensure editable area is visible */
            border: 1px dashed #BEE3F8; /* Light blue dashed border */
            padding: 0.75rem;
            border-radius: 0.375rem;
            background-color: #F0F8FF; /* Lighter background for editable area */
            cursor: text;
        }
        .exercise-list-item {
            padding: 0.25rem 0;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25);
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
        }
        .exercise-item-db {
            cursor: pointer;
            padding: 0.5rem;
            border-bottom: 1px solid #E5E7EB;
        }
        .exercise-item-db:hover {
            background-color: #F3F4F6;
        }
        .exercise-detail-section img,
        .exercise-detail-section iframe {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }
        /* Timer Styles */
        .timer-container {
            background-color: #1E3A8A; /* Deep blue */
            color: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            text-align: center;
            margin-top: 2rem;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .timer-display {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }
        .timer-controls button {
            background-color: #3B82F6; /* Brighter blue */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        .timer-controls button:hover {
            background-color: #2563EB; /* Darker blue on hover */
        }
        .timer-presets {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            gap: 0.5rem;
        }
        .timer-presets button {
            background-color: #5E98E3; /* Light blue */
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: background-color 0.2s;
        }
        .timer-presets button:hover {
            background-color: #3B82F6;
        }
        /* Checkbox & Button specific styles */
        .exercise-item-row {
            display: flex;
            align-items: center;
            justify-content: space-between; /* Pushes content to edges */
            padding: 0.25rem 0; /* Padding for each row item */
        }
        .exercise-name-text {
            flex-grow: 1; /* Allows text to take up available space */
            line-height: 1.5rem;
            cursor: pointer; /* Indicate clickable area for checkbox */
        }
        .exercise-actions-group {
            display: flex;
            align-items: center;
            gap: 0.5rem; /* Space between button and checkbox */
            flex-shrink: 0; /* Prevents this group from shrinking */
        }
        .exercise-checkbox {
            /* Custom styling for checkbox */
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #6B7280;
            border-radius: 4px;
            background-color: #E5E7EB;
            cursor: pointer;
            position: relative;
        }
        .exercise-checkbox:checked {
            background-color: #1E3A8A;
            border-color: #1E3A8A;
        }
        .exercise-checkbox:checked::after {
            content: '‚úî';
            display: block;
            color: white;
            font-size: 14px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
        }
        .exercise-item-row.completed .exercise-name-text {
            text-decoration: line-through;
            color: #6B7280; /* Gray-500 */
        }
        .record-set-btn { /* New button style for inline placement */
            background-color: #9333ea; /* Purple */
            color: white;
            padding: 0.4rem 0.8rem; /* Slightly smaller padding */
            border-radius: 0.375rem;
            font-size: 0.75rem; /* Smaller font size */
            font-weight: bold;
            transition: background-color 0.2s;
            flex-shrink: 0; /* Prevent button from shrinking */
        }
        .record-set-btn:hover {
            background-color: #7e22ce; /* Darker purple */
        }
        /* Set Logging Modal Styles */
        #setLoggingModal .modal-content {
            max-width: 400px;
            padding: 1.5rem;
            text-align: center;
        }
        #setLoggingModal .modal-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #E5E7EB;
        }
        #setLoggingModal .modal-tab-btn {
            padding: 0.75rem 1.25rem;
            font-weight: 600;
            color: #6B7280;
            transition: color 0.2s, border-bottom 0.2s;
            border-bottom: 2px solid transparent;
        }
        #setLoggingModal .modal-tab-btn.active-tab {
            color: #1E3A8A;
            border-bottom-color: #1E3A8A;
        }
        #setLoggingModal .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        #setLoggingModal input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #D1D5DB;
            border-radius: 0.375rem;
            font-size: 1rem;
            text-align: center;
        }
        #setLoggingModal #addSetBtn {
            background-color: #1E3A8A;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            transition: background-color 0.2s;
            width: 100%;
        }
        #setLoggingModal #addSetBtn:hover {
            background-color: #004AAD;
        }
        #setLoggingModal #recordedSetsList,
        #setLoggingModal #historySetsList {
            max-height: 150px;
            overflow-y: auto;
            background-color: #F3F4F6;
            border: 1px solid #E5E7EB;
            border-radius: 0.375rem;
            padding: 0.75rem;
            margin-top: 1rem;
            text-align: left;
        }
        #setLoggingModal #recordedSetsList span,
        #setLoggingModal #historySetsList div {
            display: block;
            padding: 0.3rem 0;
            border-bottom: 1px dashed #E5E7EB;
            color: #4B5563;
        }
        #setLoggingModal #recordedSetsList span:last-child,
        #setLoggingModal #historySetsList div:last-child {
            border-bottom: none;
        }
        #setLoggingModal h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        #setLoggingModal h3 {
            font-size: 1.125rem;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: #1E3A8A;
        }
    </style>
</head>
<body class="text-gray-800">

    <header class="text-center py-8">
        <h1 class="text-4xl font-bold text-gray-900">üèãÔ∏è‚Äç‚ôÇÔ∏è Jadwal Latihan Anda</h1>
        <p class="text-lg text-gray-600 mt-2">Program Latihan Push / Pull / Legs</p>
    </header>

    <main class="container mx-auto px-4">
        <section id="weekly-schedule" class="mb-8">
            <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900 text-center md:text-left mb-4 md:mb-0">Pilih Hari Latihan</h2>
                <button id="openDatabaseBtn" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold shadow-md hover:bg-indigo-700 transition-colors w-full md:w-auto">Jelajahi Database Latihan üìö</button>
            </div>
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-7 gap-4 text-center">
                <button data-day="1" class="day-btn bg-white p-4 rounded-lg shadow font-semibold">Senin<span class="block text-sm font-normal text-gray-500">Istirahat</span></button>
                <button data-day="2" class="day-btn bg-white p-4 rounded-lg shadow font-semibold">Selasa<span class="block text-sm font-normal text-blue-600">Push</span></button>
                <button data-day="3" class="day-btn bg-white p-4 rounded-lg shadow font-semibold">Rabu<span class="block text-sm font-normal text-green-600">Pull</span></button>
                <button data-day="4" class="day-btn bg-white p-4 rounded-lg shadow font-semibold">Kamis<span class="block text-sm font-normal text-gray-500">Istirahat</span></button>
                <button data-day="5" class="day-btn bg-white p-4 rounded-lg shadow font-semibold">Jumat<span class="block text-sm font-normal text-blue-600">Push</span></button>
                <button data-day="6" class="day-btn bg-white p-4 rounded-lg shadow font-semibold">Sabtu<span class="block text-sm font-normal text-red-600">Legs</span></button>
                <button data-day="0" class="day-btn bg-white p-4 rounded-lg shadow font-semibold">Minggu<span class="block text-sm font-normal text-green-600">Pull</span></button>
            </div>
        </section>

        <section id="workout-details" class="min-h-[400px]">
            <!-- Detail latihan akan dimuat di sini -->
        </section>

        <section id="rest-timer" class="timer-container mt-12 hidden">
            <h2 class="text-2xl font-bold mb-4">Timer Istirahat</h2>
            <div id="timerDisplay" class="timer-display">00:00</div>
            <div class="timer-controls space-x-4">
                <button id="startTimerBtn">Mulai</button>
                <button id="pauseTimerBtn">Jeda</button>
                <button id="resetTimerBtn">Reset</button>
            </div>
            <div class="timer-presets">
                <button data-seconds="30">30s</button>
                <button data-seconds="60">60s</button>
                <button data-seconds="90">90s</button>
                <button data-seconds="120">120s</button>
            </div>
        </section>

        <section id="tips" class="mt-12">
            <div class="exercise-card">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">‚úÖ Tips Penting untuk Latihan Anda</h2>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong>Progresif Overload:</strong> Tingkatkan beban/repetisi secara bertahap untuk terus berkembang.</li>
                    <li><strong>Prioritaskan Bentuk:</strong> Teknik yang benar lebih penting dari beban berat untuk hasil maksimal dan menghindari cedera.</li>
                    <li><strong>Pemanasan & Pendinginan:</strong> Selalu lakukan pemanasan dinamis sebelum dan peregangan statis sesudah latihan.</li>
                    <li><strong>Nutrisi & Tidur:</strong> Pastikan asupan protein cukup dan tidur berkualitas adalah kunci pemulihan dan pertumbuhan otot.</li>
                    <li><strong>Dengarkan Tubuh:</strong> Istirahat jika Anda merasa terlalu lelah atau sakit. Pemulihan adalah bagian dari latihan.</li>
                </ul>
            </div>
        </section>
    </main>

    <footer class="text-center py-8 mt-8 text-gray-500">
        <p>¬© 2025 Jadwal Latihan Gym Interaktif. Dibuat untuk memaksimalkan progres progres latihan Anda. Selamat berlatih!</p>
    </footer>

    <!-- Exercise Database Modal -->
    <div id="exerciseDatabaseModal" class="modal-overlay hidden">
        <div class="modal-content w-full md:w-3/4 lg:w-2/3">
            <button id="closeDatabaseModalBtn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-2xl font-bold">‚úñ</button>
            <h2 class="text-2xl font-bold text-gray-900 mb-4 text-center">Database Latihan</h2>
            
            <div class="mb-4">
                <input type="text" id="exerciseSearchInput" placeholder="Cari latihan..." class="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="col-span-1">
                    <h3 class="text-xl font-semibold text-gray-800 mb-3">Daftar Latihan</h3>
                    <div id="exerciseList" class="max-h-[40vh] overflow-y-auto border border-gray-200 rounded-md">
                        </div>
                </div>
                <div class="col-span-1 exercise-detail-section bg-gray-50 p-4 rounded-md hidden" id="exerciseDetailView">
                    <h3 class="text-xl font-semibold text-gray-800 mb-3" id="detailExerciseName"></h3>
                    <img id="detailExerciseImage" src="" alt="Gambar Latihan" class="mb-4 hidden">
                    <div class="relative pb-[56.25%] h-0 mb-4" id="detailExerciseVideoContainer">
                        <!-- iframe utama akan disuntikkan di sini oleh JS -->
                    </div>
                    <p class="text-gray-700 mb-3" id="detailExerciseDescription"></p>
                    <h4 class="font-semibold text-gray-700 mb-2">Instruksi:</h4>
                    <ol class="list-decimal list-inside text-gray-700 space-y-1" id="detailExerciseInstructions"></ol>
                    <p class="text-sm text-gray-500 mt-2" id="detailExerciseMuscleGroup"></p>
                    <button id="addExerciseToWorkoutBtn" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow-md hover:bg-blue-700 transition-colors w-full">Tambahkan ke Jadwal</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Set Logging Modal -->
    <div id="setLoggingModal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="closeSetLoggingModalBtn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-2xl font-bold">‚úñ</button>
            <h2 class="text-2xl font-bold text-gray-900 mb-4 text-center">Catat Set untuk <span id="loggingExerciseName" class="text-blue-700"></span></h2>
            
            <div class="modal-tabs">
                <button id="logSetTabBtn" class="modal-tab-btn active-tab">Catat Set</button>
                <button id="historyTabBtn" class="modal-tab-btn">Riwayat Set</button>
            </div>

            <div id="logSetContent" class="modal-tab-content">
                <div class="input-group">
                    <input type="number" id="logBebanInput" placeholder="Beban (kg)" min="0">
                    <input type="number" id="logRepetisiInput" placeholder="Repetisi" min="1">
                    <button id="addSetBtn">Tambah Set</button>
                </div>

                <h3 class="text-lg font-semibold mt-4 mb-2">Set yang Tercatat Hari Ini:</h3>
                <div id="recordedSetsList" class="bg-gray-50">
                    <!-- Recorded sets for today will be displayed here -->
                </div>
            </div>

            <div id="historySetContent" class="modal-tab-content hidden">
                <h3 class="text-lg font-semibold mt-4 mb-2">Riwayat Semua Set:</h3>
                <div id="historySetsList" class="bg-gray-50">
                    <!-- All historical sets will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data latihan default
        const defaultWorkoutData = {
            '2': {
                title: 'Push Day (Dada, Bahu, Trisep)',
                groups: {
                    'Dada': ['Barbell Bench Press', 'Incline Dumbbell Press', 'Dumbbell Flyes (Flat/Incline)', 'Cable Crossover'],
                    'Bahu (Depan & Samping)': ['Overhead Dumbbell Press', 'Arnold Press', 'Lateral Raises (Dumbbell/Cable)', 'Front Raises (Dumbbell/Barbell)'],
                    'Trisep': ['Close-Grip Bench Press', 'Dips (Weighted/Assisted)', 'Triceps Pushdown (Tali/Bar)', 'Overhead Dumbbell Extension', 'Skullcrushers']
                }
            },
            '3': {
                title: 'Pull Day (Punggung, Bisep)',
                groups: {
                    'Punggung': ['Barbell Rows (Bent-over)', 'Lat Pulldown', 'Seated Cable Row', 'Pull-ups / Chin-ups (Assisted jika perlu)', 'Face Pulls'],
                    'Bisep': ['Barbell Curls', 'Dumbbell Curls (Alternating/Hammer/Supinating)', 'Preacher Curls', 'Cable Curls']
                }
            },
            '5': {
                title: 'Push Day (Variasi)',
                groups: {
                    'Dada': ['Dumbbell Bench Press (Flat/Decline)', 'Machine Chest Press', 'Pec Deck Fly', 'Push-ups (Weighted/Variasi)'],
                    'Bahu (Depan & Samping)': ['Machine Shoulder Press', 'Upright Rows (Hati-hati jika tidak nyaman)', 'Single-Arm Cable Lateral Raise', 'Plate Front Raise'],
                    'Trisep': ['Cable Rope Pushdown', 'Single-Arm Overhead Cable Extension', 'Dumbbell Kickbacks']
                }
            },
            '6': {
                title: 'Leg Day',
                groups: {
                    'Paha Depan & Belakang, Bokong': ['Barbell Squats', 'Romanian Deadlifts (RDLs)', 'Leg Press', 'Walking Lunges (Dumbbell/Barbell)', 'Leg Extension', 'Leg Curl'],
                    'Betis': ['Standing Calf Raises', 'Seated Calf Raises']
                }
            },
            '0': {
                title: 'Pull Day (Fokus Bahu Belakang)',
                groups: {
                    'Punggung': ['Deadlifts (Opsional)', 'T-Bar Rows', 'Single-Arm Dumbbell Rows', 'Straight-Arm Pulldown'],
                    'Bisep': ['Concentration Curls', 'Hammer Curls', 'Reverse Curls'],
                    'Bahu Belakang (Rear Delts)': ['Face Pulls (menggunakan tali)', 'Reverse Pec Deck Fly', 'Bent-Over Dumbbell Lateral Raises']
                }
            },
            '1': { title: 'Istirahat Total', groups: {} },
            '4': { title: 'Istirahat Aktif', groups: { 'Saran': ['Jalan santai', 'Yoga ringan', 'Peregangan', 'Kardio intensitas rendah'] } }
        };

        // --- DATABASE LATIHAN ---
        const exerciseDatabase = [
            {
                id: 'ex001', name: 'Barbell Bench Press', muscleGroup: 'Dada',
                description: 'Latihan dasar untuk membangun massa dan kekuatan dada. Melibatkan dada, bahu depan, dan trisep.',
                instructions: [
                    'Berbaring telentang di bangku datar, kaki menapak lantai.',
                    'Genggam barbel sedikit lebih lebar dari lebar bahu, dengan tangan di atas (overhand grip).',
                    'Turunkan barbel secara perlahan ke arah dada bagian tengah.',
                    'Dorong barbel kembali ke posisi awal, kunci siku di bagian atas gerakan.'
                ],
                imageUrl: 'https://www.inspireusafoundation.org/wp-content/uploads/2022/04/barbell-bench-press.gif',
                videoUrl: 'https://www.youtube.com/embed/gRVjAtPip0Y?si=_YqIaLrpA36yYpKD'
            },
            {
                id: 'ex002', name: 'Dumbbell Curl', muscleGroup: 'Bisep',
                description: 'Latihan isolasi efektif untuk bisep, memungkinkan rentang gerak penuh dan aktivasi serat otot yang baik.',
                instructions: [
                    'Berdiri tegak atau duduk di bangku dengan punggung lurus, pegang dumbel di masing-masing tangan, telapak tangan menghadap ke depan.',
                    'Gulung dumbel ke atas menuju bahu sambil mengencangkan bisep, jaga siku tetap di sisi tubuh.',
                    'Kontraksikan bisep di puncak gerakan.',
                    'Turunkan dumbel secara perlahan kembali ke posisi awal dengan kontrol.'
                ],
                imageUrl: 'https://www.inspireusafoundation.org/wp-content/uploads/2022/03/dumbbell-bicep-curl.gif',
                videoUrl: 'https://www.youtube.com/embed/6DeLZ6cbgWQ?si=Pm0AKFhrTW1eSllP'
            },
            {
                id: 'ex003', name: 'Barbell Squats', muscleGroup: 'Kaki',
                description: 'Salah satu latihan compound terbaik untuk melatih seluruh tubuh bagian bawah dan inti. Membangun kekuatan dan massa kaki secara keseluruhan.',
                instructions: [
                    'Posisikan barbel di punggung bagian atas (otot trapezius), pegang barbel dengan tangan di atas bahu.',
                    'Berdiri dengan kaki selebar bahu, jari kaki sedikit mengarah keluar.',
                    'Mulai gerakan dengan menekuk lutut dan pinggul, seolah duduk di kursi. Jaga punggung tetap lurus.',
                    'Turunkan tubuh hingga paha sejajar lantai atau lebih rendah, jaga tumit tetap di lantai.',
                    'Dorong kembali ke posisi awal, fokus pada kontraksi otot paha dan bokong.'
                ],
                imageUrl: 'https://www.inspireusafoundation.org/wp-content/uploads/2022/03/barbell-full-squat.gif',
                videoUrl: 'https://www.youtube.com/embed/eFYv8Skf66g?si=6AeSC9jOWH4KwHTv'
            },
            {
                id: 'ex004', name: 'Lat Pulldown', muscleGroup: 'Punggung',
                description: 'Latihan yang bagus untuk menargetkan otot punggung bagian lebar (latissimus dorsi) untuk membangun punggung yang lebar dan kuat.',
                instructions: [
                    'Duduk di mesin lat pulldown, sesuaikan bantalan lutut agar pas.',
                    'Genggam bilah lebar dengan telapak tangan menghadap ke depan (overhand grip).',
                    'Tarik bilah ke bawah menuju dada bagian atas, fokus pada menarik siku ke bawah dan ke belakang.',
                    'Kontraksikan otot punggung di bagian bawah gerakan.',
                    'Biarkan bilah kembali ke posisi awal secara perlahan dan terkontrol, regangkan lat Anda.'
                ],
                imageUrl: 'https://www.inspireusafoundation.org/wp-content/uploads/2021/10/lat-pulldown-768x598.png',
                videoUrl: 'https://www.youtube.com/embed/trZQjegcRx0?si=UA6jF7z32z31c1E9'
            },
            {
                id: 'ex005', name: 'Overhead Dumbbell Press', muscleGroup: 'Bahu',
                description: 'Latihan efektif untuk melatih bahu (deltoid) dan trisep, bisa dilakukan duduk atau berdiri.',
                instructions: [
                    'Duduk atau berdiri tegak, pegang dumbel di setiap tangan setinggi bahu, telapak tangan menghadap ke depan atau sedikit ke dalam.',
                    'Dorong dumbel lurus ke atas hingga lengan terentang penuh di atas kepala, tapi jangan kunci siku.',
                    'Turunkan dumbel secara perlahan kembali ke posisi awal dengan kontrol.',
                    'Jaga inti tubuh tetap kencang sepanjang gerakan.'
                ],
                imageUrl: 'https://cdn-0.weighttraining.guide/wp-content/uploads/2016/05/Dumbbell-Shoulder-Press-resized.png',
                videoUrl: 'https://www.youtube.com/embed/HzIiNhHhhtA?si=_8AOMMr6H1iFi_V-'
            },
            {
                id: 'ex006', name: 'Romanian Deadlifts (RDLs)', muscleGroup: 'Kaki',
                description: 'Latihan utama untuk hamstring dan bokong, berfokus pada gerakan "hinging" pinggul yang aman dan efektif.',
                instructions: [
                    'Berdiri tegak dengan barbel atau dumbel di depan paha, genggam dengan tangan lebih lebar dari lebar bahu.',
                    'Jaga punggung lurus dan sedikit tekuk lutut.',
                    'Mulai gerakan dengan mendorong pinggul ke belakang, biarkan beban turun di depan kaki Anda.',
                    'Rasakan regangan di hamstring. Turunkan beban sampai Anda merasakan regangan yang baik atau sebelum punggung Anda melengkung.',
                    'Dorong pinggul ke depan untuk kembali ke posisi awal, kontraksikan bokong di bagian atas.'
                ],
                imageUrl: 'https://www.inspireusafoundation.org/wp-content/uploads/2022/06/barbell-romanian-deadlift-movement.gif',
                videoUrl: 'https://www.youtube.com/embed/CN_7cz3P-1U?si=hc_KoZpthvVbGaQy'
            },
            {
                id: 'ex007', name: 'Cable Crossover', muscleGroup: 'Dada',
                description: 'Latihan isolasi untuk dada bagian dalam dan luar, memberikan kontraksi yang kuat pada otot dada.',
                instructions: [
                    'Berdiri di tengah mesin kabel crossover, pegang pegangan di kedua tangan, pastikan katrol berada di ketinggian yang sesuai (biasanya setinggi bahu atau sedikit lebih tinggi).',
                    'Condongkan tubuh sedikit ke depan, dengan sedikit tekuk pada siku.',
                    'Satukan pegangan di depan dada, fokus pada kontraksi otot dada.',
                    'Kembali ke posisi awal secara perlahan, rasakan regangan di dada Anda.'
                ],
                imageUrl: 'https://www.inspireusafoundation.org/wp-content/uploads/2024/02/cable-standing-crossover.gif',
                videoUrl: 'https://www.youtube.com/embed/JCj-9l9y9tY0'
            },
            {
                id: 'ex008', name: 'Face Pulls', muscleGroup: 'Bahu',
                description: 'Latihan yang sangat baik untuk melatih bahu belakang (rear delts) dan otot-otot rotator cuff, meningkatkan kesehatan bahu dan postur.',
                instructions: [
                    'Atur katrol kabel setinggi wajah atau sedikit lebih tinggi, gunakan tali pegangan.',
                    'Mundur beberapa langkah dari mesin untuk mendapatkan ketegangan pada kabel.',
                    'Tarik tali ke arah wajah Anda, fokus pada menarik siku ke belakang dan ke luar. Pikirkan untuk memutar bahu Anda ke luar.',
                    'Remas bahu belakang Anda di puncak gerakan, lalu lepaskan secara perlahan.'
                ],
                imageUrl: 'https://www.inspireusafoundation.org/wp-content/uploads/2022/03/cable-face-pull.gif',
                videoUrl: 'https://www.youtube.com/embed/V8dZ3pyiCBo?si=SoigiAK3BtKqoB9d'
            },
            {
                id: 'ex009', name: 'Arnold Press', muscleGroup: 'Bahu',
                description: 'Latihan yang sangat baik untuk melatih bahu belakang (rear delts) dan otot-otot rotator cuff, meningkatkan kesehatan bahu dan postur.',
                instructions: [
                    'Posisi Awal: Duduk/berdiri tegak, pegang dumbbell setinggi bahu, telapak tangan menghadap ke dalam (ke arah tubuh).',
                    'Angkat & Putar: Dorong dumbbell ke atas sambil memutar pergelangan tangan ke luar (telapak tangan menghadap ke depan) hingga lengan terentang penuh di atas kepala.',
                    'Turunkan & Putar Kembali: Turunkan dumbbell secara perlahan, sambil memutar pergelangan tangan ke dalam (telapak tangan kembali menghadap tubuh) hingga dumbbell kembali ke posisi awal di bahu',
                    'Ulangi: Jaga kontrol, jangan mengunci siku di atas.'
                ],
                imageUrl: 'https://www.inspireusafoundation.org/wp-content/uploads/2022/04/arnold-presses.gif',
                videoUrl: 'https://www.youtube.com/embed/pQDrcNoDNVM?si=3-d0FQk4VtM1h3jr'
            },
        ];


        // Muat data kustom dari localStorage jika ada
        let customWorkoutData = JSON.parse(localStorage.getItem('customGymWorkout')) || {};
        // Data status checkbox latihan yang diselesaikan per tanggal sesi
        let completedExercisesData = JSON.parse(localStorage.getItem('completedGymExercises')) || {};
        // Data beban dan repetisi yang dicatat, per tanggal sesi
        let loggedSetsData = JSON.parse(localStorage.getItem('loggedGymSets')) || {};

        const detailsContainer = document.getElementById('workout-details');
        const dayButtons = document.querySelectorAll('.day-btn');
        let currentActiveDay = null;
        let isEditMode = false;
        let currentActiveGroupForAdding = null; // Variabel untuk melacak kelompok otot yang sedang diedit

        // --- Variabel Timer ---
        let timerInterval;
        let timeLeft = 0; // Waktu tersisa dalam detik
        let isTimerRunning = false;
        let initialTimerDuration = 0; // Untuk reset
        const timerDisplay = document.getElementById('timerDisplay');
        const startTimerBtn = document.getElementById('startTimerBtn');
        const pauseTimerBtn = document.getElementById('pauseTimerBtn');
        const resetTimerBtn = document.getElementById('resetTimerBtn');
        const timerPresets = document.querySelectorAll('#rest-timer .timer-presets button');
        const restTimerSection = document.getElementById('rest-timer');
        // --- Akhir Variabel Timer ---

        // --- Variabel Modal Pencatat Set ---
        const setLoggingModal = document.getElementById('setLoggingModal');
        const closeSetLoggingModalBtn = document.getElementById('closeSetLoggingModalBtn');
        const loggingExerciseNameSpan = document.getElementById('loggingExerciseName');
        const logBebanInput = document.getElementById('logBebanInput');
        const logRepetisiInput = document.getElementById('logRepetisiInput');
        const addSetBtn = document.getElementById('addSetBtn');
        const recordedSetsList = document.getElementById('recordedSetsList');
        const logSetTabBtn = document.getElementById('logSetTabBtn');
        const historyTabBtn = document.getElementById('historyTabBtn');
        const logSetContent = document.getElementById('logSetContent');
        const historySetContent = document.getElementById('historySetContent');
        const historySetsList = document.getElementById('historySetsList');
        let currentLoggingExercise = null; // Latihan yang sedang dicatat set-nya
        // --- Akhir Variabel Modal Pencatat Set ---


        function getTodayDate() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`;
        }

        function startTimer() {
            if (isTimerRunning) return;
            isTimerRunning = true;
            if (timeLeft === 0 && initialTimerDuration > 0) { // Jika timer direset dan ingin mulai lagi
                timeLeft = initialTimerDuration;
            } else if (timeLeft === 0 && initialTimerDuration === 0) { // Jika belum ada durasi diatur
                alert('Pilih durasi timer terlebih dahulu atau atur waktu manual.');
                isTimerRunning = false;
                return;
            }

            timerInterval = setInterval(() => {
                if (timeLeft > 0) {
                    timeLeft--;
                    timerDisplay.textContent = formatTime(timeLeft);
                } else {
                    clearInterval(timerInterval);
                    isTimerRunning = false;
                    timerDisplay.textContent = "00:00";
                    alert('Waktu istirahat selesai!');
                    // Bisa tambahkan suara notifikasi di sini
                }
            }, 1000);
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            isTimerRunning = false;
        }

        function resetTimer() {
            clearInterval(timerInterval);
            isTimerRunning = false;
            timeLeft = initialTimerDuration; // Kembali ke durasi awal
            timerDisplay.textContent = formatTime(timeLeft);
        }


        function renderWorkoutContent(day, data, editing) {
            const todayDate = getTodayDate();
            let content = '';
            content += `<div class="exercise-card animate-fade-in">`;
            content += `<div class="flex justify-between items-center mb-6">`;
            content += `<h2 class="text-3xl font-bold text-gray-900">${data.title}</h2>`;
            content += `<div class="flex space-x-2">`;
            content += `<button id="editBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow-md hover:bg-blue-700 transition-colors ${editing ? 'hidden' : ''}">Edit</button>`;
            content += `<button id="saveBtn" class="bg-green-600 text-white px-4 py-2 rounded-lg font-semibold shadow-md hover:bg-green-700 transition-colors ${!editing ? 'hidden' : ''}">Simpan</button>`;
            content += `</div></div>`;
            
            const groups = Object.keys(data.groups);
            if (groups.length > 0) {
                content += `<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">`;
                groups.forEach(groupName => {
                    content += `<div class="exercise-group">`;
                    content += `<div class="flex justify-between items-center mb-3">`;
                    content += `<h3>${groupName}</h3>`;
                    if (editing) {
                        content += `<button class="add-exercise-to-group-btn bg-blue-500 text-white text-xs px-2 py-1 rounded-md hover:bg-blue-600 transition-colors" data-group="${groupName}">+ Tambah</button>`;
                    }
                    content += `</div>`; // End flex for group title and button
                    
                    if (editing) {
                        content += `<div class="editable-list" contenteditable="true" data-group="${groupName}">`;
                        data.groups[groupName].forEach(exercise => {
                            content += `<div class="exercise-list-item">${exercise}</div>`;
                        });
                        content += `</div>`;
                    } else {
                        content += `<ul class="list-disc list-inside space-y-2 text-gray-700">`;
                        data.groups[groupName].forEach(exercise => {
                            const isCompleted = completedExercisesData[todayDate]?.[day]?.[exercise] || false;
                            
                            // Updated structure for clean UI
                            content += `<li data-exercise-name="${exercise}" class="exercise-item-row ${isCompleted ? 'completed' : ''}">`;
                            content += `<span class="exercise-name-text">${exercise}</span>`; // Text of the exercise
                            content += `<div class="exercise-actions-group">`; // Group for button and checkbox
                            content += `<button class="record-set-btn" data-exercise-name="${exercise}">Set</button>`;
                            content += `<input type="checkbox" class="exercise-checkbox" ${isCompleted ? 'checked' : ''}>`;
                            content += `</div>`;
                            content += `</li>`;
                        });
                        content += `</ul>`;
                    }
                    content += `</div>`;
                });
                content += `</div>`;
            } else {
                content += `<p class="text-center text-gray-600 text-lg mt-8">Manfaatkan hari ini untuk pemulihan otot dan energi. Tubuh Anda butuh istirahat untuk tumbuh lebih kuat!</p>`;
            }

            content += `</div>`;
            detailsContainer.innerHTML = content;
        }

        function displayWorkout(day, editing = false) {
            currentActiveDay = day;
            isEditMode = editing;

            // Prioritaskan data kustom, jika tidak ada, gunakan default
            const dataToDisplay = customWorkoutData[day] || defaultWorkoutData[day];
            
            renderWorkoutContent(day, dataToDisplay, editing);

            // Tambahkan event listener untuk tombol Edit/Save
            const editBtn = document.getElementById('editBtn');
            const saveBtn = document.getElementById('saveBtn');

            if (editBtn) {
                editBtn.onclick = () => displayWorkout(currentActiveDay, true);
            }
            if (saveBtn) {
                saveBtn.onclick = saveWorkout;
            }

            // Tambahkan event listener untuk tombol "Tambah Latihan" per kelompok otot
            if (editing) {
                document.querySelectorAll('.add-exercise-to-group-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        currentActiveGroupForAdding = e.target.dataset.group;
                        document.getElementById('openDatabaseBtn').click(); // Membuka modal database
                    });
                });
            } else {
                // Tambahkan event listener untuk checkbox latihan
                document.querySelectorAll('.exercise-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        const li = e.target.closest('.exercise-item-row'); // Closest li with the new class
                        const exerciseName = li.dataset.exerciseName;
                        const isChecked = e.target.checked;
                        toggleExerciseCompletion(currentActiveDay, exerciseName, isChecked);
                    });
                });
                // Tambahkan event listener untuk tombol "Catat Set" utama
                document.querySelectorAll('.record-set-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const exerciseName = e.target.dataset.exerciseName;
                        openSetLoggingModal(exerciseName);
                    });
                });
            }
            
            dayButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.day === day) {
                    btn.classList.add('active');
                }
            });

            // Tampilkan atau sembunyikan timer berdasarkan apakah ada latihan
            if (dataToDisplay.groups && Object.keys(dataToDisplay.groups).length > 0) {
                restTimerSection.classList.remove('hidden');
            } else {
                restTimerSection.classList.add('hidden');
            }
        }

        function saveWorkout() {
            const currentDayData = {
                title: defaultWorkoutData[currentActiveDay].title, // Judul tetap dari default
                groups: {}
            };

            document.querySelectorAll('.editable-list').forEach(listDiv => {
                const groupName = listDiv.dataset.group;
                const exercises = [];
                listDiv.innerText.split('\n').forEach(line => {
                    const trimmedLine = line.trim();
                    if (trimmedLine.length > 0) {
                        exercises.push(trimmedLine);
                    }
                });
                currentDayData.groups[groupName] = exercises;
            });

            customWorkoutData[currentActiveDay] = currentDayData;
            localStorage.setItem('customGymWorkout', JSON.stringify(customWorkoutData));
            
            displayWorkout(currentActiveDay, false); // Setelah menyimpan, tampilkan kembali dalam mode tampilan
            alert('Perubahan jadwal berhasil disimpan!');
        }

        function toggleExerciseCompletion(dayId, exerciseName, isCompleted) {
            const todayDate = getTodayDate();
            if (!completedExercisesData[todayDate]) {
                completedExercisesData[todayDate] = {};
            }
            if (!completedExercisesData[todayDate][dayId]) {
                completedExercisesData[todayDate][dayId] = {};
            }
            completedExercisesData[todayDate][dayId][exerciseName] = isCompleted;
            localStorage.setItem('completedGymExercises', JSON.stringify(completedExercisesData));

            // Perbarui tampilan item latihan secara langsung
            const exerciseLi = document.querySelector(`li[data-exercise-name="${exerciseName}"]`);
            if (exerciseLi) {
                // Apply 'completed' class directly to the li.exercise-item-row
                if (isCompleted) {
                    exerciseLi.classList.add('completed');
                } else {
                    exerciseLi.classList.remove('completed');
                }
            }
        }

        function recordSet(dayId, exerciseName, beban, repetisi) {
            const todayDate = getTodayDate();
            if (!loggedSetsData[todayDate]) {
                loggedSetsData[todayDate] = {};
            }
            if (!loggedSetsData[todayDate][dayId]) {
                loggedSetsData[todayDate][dayId] = {};
            }
            if (!loggedSetsData[todayDate][dayId][exerciseName]) {
                loggedSetsData[todayDate][dayId][exerciseName] = [];
            }
            loggedSetsData[todayDate][dayId][exerciseName].push({ beban, repetisi });
            localStorage.setItem('loggedGymSets', JSON.stringify(loggedSetsData));
        }

        // --- Logic for Set Logging Modal ---
        function openSetLoggingModal(exerciseName) {
            currentLoggingExercise = exerciseName;
            loggingExerciseNameSpan.textContent = exerciseName;
            logBebanInput.value = '';
            logRepetisiInput.value = '';
            
            // Default to "Catat Set" tab
            showSetLoggingTab('logSet');
            renderRecordedSets(); // Tampilkan set yang sudah ada untuk hari ini
            
            setLoggingModal.classList.remove('hidden');
        }

        function showSetLoggingTab(tab) {
            // Remove active class from all tabs
            logSetTabBtn.classList.remove('active-tab');
            historyTabBtn.classList.remove('active-tab');
            // Hide all content areas
            logSetContent.classList.add('hidden');
            historySetContent.classList.add('hidden');

            if (tab === 'logSet') {
                logSetTabBtn.classList.add('active-tab');
                logSetContent.classList.remove('hidden');
                renderRecordedSets(); // Re-render today's sets
            } else if (tab === 'history') {
                historyTabBtn.classList.add('active-tab');
                historySetContent.classList.remove('hidden');
                renderHistoricalSets(); // Render all historical sets
            }
        }

        function renderRecordedSets() {
            const todayDate = getTodayDate();
            const sets = loggedSetsData[todayDate]?.[currentActiveDay]?.[currentLoggingExercise] || [];
            recordedSetsList.innerHTML = '';
            if (sets.length === 0) {
                recordedSetsList.innerHTML = '<span class="text-gray-500 text-center block">Belum ada set yang dicatat hari ini.</span>';
                return;
            }
            sets.forEach((set, index) => {
                const setItem = document.createElement('span');
                setItem.textContent = `Set ${index + 1}: ${set.beban} kg x ${set.repetisi} reps`;
                recordedSetsList.appendChild(setItem);
            });
        }

        function renderHistoricalSets() {
            historySetsList.innerHTML = '';
            const allHistory = [];

            // Iterate through all dates in loggedSetsData
            for (const date in loggedSetsData) {
                // Check if data exists for the current active day and logging exercise
                if (loggedSetsData[date][currentActiveDay] && loggedSetsData[date][currentActiveDay][currentLoggingExercise]) {
                    const setsForThisDay = loggedSetsData[date][currentActiveDay][currentLoggingExercise];
                    allHistory.push({ date: date, sets: setsForThisDay });
                }
            }

            // Sort history by date (newest first)
            allHistory.sort((a, b) => new Date(b.date) - new Date(a.date));

            if (allHistory.length === 0) {
                historySetsList.innerHTML = '<span class="text-gray-500 text-center block">Belum ada riwayat set untuk latihan ini.</span>';
                return;
            }

            allHistory.forEach(dayEntry => {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'mb-2 pb-2 border-b border-gray-200';
                dayDiv.innerHTML = `<h4 class="font-semibold text-gray-800 text-sm mb-1">${dayEntry.date}</h4>`;
                dayEntry.sets.forEach((set, index) => {
                    dayDiv.innerHTML += `<span>Set ${index + 1}: ${set.beban} kg x ${set.repetisi} reps</span><br>`;
                });
                historySetsList.appendChild(dayDiv);
            });
        }


        closeSetLoggingModalBtn.addEventListener('click', () => {
            setLoggingModal.classList.add('hidden');
            displayWorkout(currentActiveDay, false); // Refresh tampilan utama setelah menutup modal
        });

        setLoggingModal.addEventListener('click', (e) => {
            if (e.target === setLoggingModal) {
                setLoggingModal.classList.add('hidden');
                displayWorkout(currentActiveDay, false); // Refresh tampilan utama setelah menutup modal
            }
        });

        addSetBtn.addEventListener('click', () => {
            const beban = parseFloat(logBebanInput.value);
            const repetisi = parseInt(logRepetisiInput.value);

            if (isNaN(beban) || isNaN(repetisi) || beban <= 0 || repetisi <= 0) {
                alert('Mohon masukkan beban dan repetisi yang valid.');
                return;
            }

            recordSet(currentActiveDay, currentLoggingExercise, beban, repetisi);
            logBebanInput.value = '';
            logRepetisiInput.value = '';
            renderRecordedSets(); // Perbarui daftar set di modal "Catat Set"
        });

        // Event Listeners for Set Logging Modal Tabs
        logSetTabBtn.addEventListener('click', () => showSetLoggingTab('logSet'));
        historyTabBtn.addEventListener('click', () => showSetLoggingTab('history'));

        // --- End Logic for Set Logging Modal ---


        dayButtons.forEach(button => {
            button.addEventListener('click', () => {
                const day = button.dataset.day;
                displayWorkout(day, false); // Selalu mulai dalam mode tampilan
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            // --- Logic for Exercise Database Modal ---
            const exerciseDatabaseModal = document.getElementById('exerciseDatabaseModal');
            const openDatabaseBtn = document.getElementById('openDatabaseBtn');
            const closeDatabaseModalBtn = document.getElementById('closeDatabaseModalBtn');
            const exerciseListDiv = document.getElementById('exerciseList');
            const exerciseSearchInput = document.getElementById('exerciseSearchInput');
            const exerciseDetailView = document.getElementById('exerciseDetailView');
            const detailExerciseName = document.getElementById('detailExerciseName');
            const detailExerciseImage = document.getElementById('detailExerciseImage');
            const detailExerciseVideoContainer = document.getElementById('detailExerciseVideoContainer');
            const detailExerciseVideo = document.getElementById('detailExerciseVideo');
            const detailExerciseDescription = document.getElementById('detailExerciseDescription');
            const detailExerciseInstructions = document.getElementById('detailExerciseInstructions');
            const detailExerciseMuscleGroup = document.getElementById('detailExerciseMuscleGroup');
            const addExerciseToWorkoutBtn = document.getElementById('addExerciseToWorkoutBtn');


            openDatabaseBtn.addEventListener('click', () => {
                exerciseDatabaseModal.classList.remove('hidden');
                renderExerciseList(exerciseDatabase); // Tampilkan semua latihan saat modal dibuka
                exerciseDetailView.classList.add('hidden'); // Sembunyikan detail saat pertama dibuka
                exerciseSearchInput.value = ''; // Kosongkan input pencarian
                // Sembunyikan tombol "Tambahkan ke Jadwal" jika tidak dalam mode edit
                if (!isEditMode) {
                    addExerciseToWorkoutBtn.classList.add('hidden');
                } else {
                    addExerciseToWorkoutBtn.classList.remove('hidden');
                }
            });

            closeDatabaseModalBtn.addEventListener('click', () => {
                exerciseDatabaseModal.classList.add('hidden');
            });

            exerciseDatabaseModal.addEventListener('click', (e) => {
                if (e.target === exerciseDatabaseModal) {
                    exerciseDatabaseModal.classList.add('hidden');
                }
            });

            exerciseSearchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                const filteredExercises = exerciseDatabase.filter(ex => 
                    ex.name.toLowerCase().includes(searchTerm) ||
                    ex.muscleGroup.toLowerCase().includes(searchTerm)
                );
                renderExerciseList(filteredExercises);
            });

            function renderExerciseList(exercises) {
                exerciseListDiv.innerHTML = '';
                if (exercises.length === 0) {
                    exerciseListDiv.innerHTML = '<p class="p-4 text-center text-gray-500">Tidak ada latihan yang ditemukan.</p>';
                    return;
                }
                exercises.forEach(ex => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'exercise-item-db p-2 hover:bg-gray-100 transition-colors';
                    itemDiv.innerHTML = `<span class="font-semibold text-gray-800">${ex.name}</span> <span class="text-sm text-gray-500">(${ex.muscleGroup})</span>`;
                    itemDiv.dataset.id = ex.id;
                    itemDiv.addEventListener('click', () => showExerciseDetail(ex.id));
                    exerciseListDiv.appendChild(itemDiv);
                });
            }

            function showExerciseDetail(exerciseId) {
                const exercise = exerciseDatabase.find(ex => ex.id === exerciseId);
                if (!exercise) return;

                detailExerciseName.textContent = exercise.name;
                detailExerciseDescription.textContent = exercise.description;
                detailExerciseMuscleGroup.textContent = `Kelompok Otot: ${exercise.muscleGroup}`;

                detailExerciseInstructions.innerHTML = '';
                exercise.instructions.forEach(inst => {
                    const li = document.createElement('li');
                    li.textContent = inst;
                    detailExerciseInstructions.appendChild(li);
                });

                if (exercise.imageUrl) {
                    detailExerciseImage.src = exercise.imageUrl;
                    detailExerciseImage.classList.remove('hidden');
                } else {
                    detailExerciseImage.classList.add('hidden');
                }

                if (exercise.videoUrl) {
                    detailExerciseVideoContainer.innerHTML = `
                        <iframe class="absolute top-0 left-0 w-full h-full rounded-md" 
                                src="${exercise.videoUrl}" 
                                frameborder="0" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                        </iframe>
                    `;
                    detailExerciseVideoContainer.classList.remove('hidden');
                } else {
                    detailExerciseVideoContainer.innerHTML = '';
                    detailExerciseVideoContainer.classList.add('hidden');
                }

                addExerciseToWorkoutBtn.dataset.exerciseName = exercise.name;
                exerciseDetailView.classList.remove('hidden');
            }

            addExerciseToWorkoutBtn.addEventListener('click', () => {
                const exerciseName = addExerciseToWorkoutBtn.dataset.exerciseName;
                if (exerciseName && currentActiveGroupForAdding) {
                    const editableList = document.querySelector(`.editable-list[data-group="${currentActiveGroupForAdding}"]`);
                    if (editableList) {
                        const newItem = document.createElement('div');
                        newItem.className = 'exercise-list-item';
                        newItem.textContent = exerciseName;
                        editableList.appendChild(newItem);
                        editableList.scrollTop = editableList.scrollHeight;
                        exerciseDatabaseModal.classList.add('hidden');
                        alert(`"${exerciseName}" ditambahkan ke ${currentActiveGroupForAdding}!`);
                    }
                }
            });
            // --- END Logic for Exercise Database Modal ---

            // --- Event Listeners untuk Timer ---
            startTimerBtn.addEventListener('click', startTimer);
            pauseTimerBtn.addEventListener('click', pauseTimer);
            resetTimerBtn.addEventListener('click', resetTimer);

            timerPresets.forEach(button => {
                button.addEventListener('click', (e) => {
                    const seconds = parseInt(e.target.dataset.seconds);
                    timeLeft = seconds;
                    initialTimerDuration = seconds;
                    timerDisplay.textContent = formatTime(timeLeft);
                    pauseTimer();
                });
            });
            // --- Akhir Event Listeners Timer ---

            const today = new Date().getDay();
            const todayButton = document.querySelector(`.day-btn[data-day="${today}"]`);
            if (todayButton) {
                todayButton.click();
            } else {
                displayWorkout('1');
            }
        });
    </script>
</body>
</html>
